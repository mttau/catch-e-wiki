<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="keywords" content="Office(xls) Format,Derived Fields,Encrypted Fields,Gb::Queries::executeQueries(),Global Controls,Job Scheduler,Job Scheduler:Job,Job Scheduler:Queue,Job Scheduler:Schedule,Main Page,Message" />
<link rel="shortcut icon" href="../../favicon.ico" />
		<title>Office(xls) Format - Help wiki</title>
		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "../skins/catche/main.css%3F7.css"; /*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print" href="../skins/common/commonPrint.css" />
		<!--[if lt IE 5.5000]><style type="text/css">@import "/mediawiki/skins/catche/IE50Fixes.css";</style><![endif]-->
		<!--[if IE 5.5000]><style type="text/css">@import "/mediawiki/skins/catche/IE55Fixes.css";</style><![endif]-->
		<!--[if IE 6]><style type="text/css">@import "/mediawiki/skins/catche/IE60Fixes.css";</style><![endif]-->
		<!--[if IE 7]><style type="text/css">@import "/mediawiki/skins/catche/IE70Fixes.css?1";</style><![endif]-->
		<!--[if lt IE 7]><script type="text/javascript" src="/mediawiki/skins/common/IEFixes.js"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
		<script type="text/javascript">var skin = 'catche';var stylepath = '/mediawiki/skins';</script>
		<script type="text/javascript" src="../skins/common/wikibits.js"><!-- wikibits js --></script>
		<script type="text/javascript" src="../index.php%3Ftitle=-&amp;action=raw&amp;gen=js"><!-- site js --></script>
		<style type="text/css">/*<![CDATA[*/
@import "../index.php%3Ftitle=MediaWiki:Common.css&action=raw&ctype=text%252Fcss&smaxage=18000.css";
@import "../index.php%3Ftitle=MediaWiki:Catche.css&action=raw&ctype=text%252Fcss&smaxage=18000.css";
@import "../index.php%3Ftitle=-&action=raw&gen=css&maxage=18000.css";
/*]]>*/</style>
		<!-- Head Scripts -->
		      <style>
        <!--
        .editsection { display: none; }
        -->
      </style>
	</head>
<body  class="ns-0 ltr">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 class="firstHeading">Office(xls) Format</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Help wiki</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="Office(xls)_Format.html#column-one">navigation</a>, <a href="Office(xls)_Format.html#searchInput">search</a></div>			<!-- start content -->
			<p><a href="Main_Page.html" title="Main Page">Main Page</a> &rarr; <a href="SYSTEM.html" title="SYSTEM">System</a> / <a href="Job_Scheduler.html" title="Job Scheduler">Scheduler</a> &rarr; <a href="./Job_Scheduler:Schedule.html" title="Job Scheduler:Schedule">Schedule</a> | <a href="./Job_Scheduler:Job.html" title="Job Scheduler:Job">Job</a> | <a href="./Job_Scheduler:Queue.html" title="Job Scheduler:Queue">Queue</a> &rarr; <a href="Scheduler_Job_Types.html" title="Scheduler Job Types">Method</a> | <a href="Message.html" title="Message">Message</a> &rarr; <a href="./Image:Check.png.html" class="image" title="Image:check.png"><img src="../../clients/help/wiki/images/2/2a/Check.png" alt="Image:check.png" width="30" height="30" longdesc="/mediawiki/index.php/Image:Check.png" /></a><a href="Scheduler_Setup.html" title="Scheduler Setup">Scheduler Setup</a> &rarr; <a href="User_Defined_Queries.html" title="User Defined Queries">User Defined Queries</a> | <a href="Derived_Fields.html" title="Derived Fields">Derived Fields</a> | <a href="Encrypted_Fields.html" title="Encrypted Fields">Encrypted Fields</a> | <strong>Office(xls) Format</strong> | <a href="Office(xlsx).html" title="Office(xlsx)"> Office(xlsx) Format</a>
</p>
<hr />
<table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class='toclevel-1'><a href="Office(xls)_Format.html#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a></li>
<li class='toclevel-1'><a href="Office(xls)_Format.html#Standard_Settings"><span class="tocnumber">2</span> <span class="toctext">Standard Settings</span></a></li>
<li class='toclevel-1'><a href="Office(xls)_Format.html#Output_Change"><span class="tocnumber">3</span> <span class="toctext">Output Change</span></a></li>
<li class='toclevel-1'><a href="Office(xls)_Format.html#Creating_an_Excel_Spreadsheet"><span class="tocnumber">4</span> <span class="toctext">Creating an Excel Spreadsheet</span></a></li>
<li class='toclevel-1'><a href="Office(xls)_Format.html#Embedded_Formulae"><span class="tocnumber">5</span> <span class="toctext">Embedded Formulae</span></a></li>
<li class='toclevel-1'><a href="Office(xls)_Format.html#Default_Spreadsheet_Formats"><span class="tocnumber">6</span> <span class="toctext">Default Spreadsheet Formats</span></a>
<ul>
<li class='toclevel-2'><a href="Office(xls)_Format.html#Sample_Company_Default_Spreadsheet_Format"><span class="tocnumber">6.1</span> <span class="toctext">Sample Company Default Spreadsheet Format</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="Office(xls)_Format.html#Customised_Spreadsheet_Formats"><span class="tocnumber">7</span> <span class="toctext">Customised Spreadsheet Formats</span></a></li>
<li class='toclevel-1'><a href="Office(xls)_Format.html#Sample_Customised_Spreadsheet_Format"><span class="tocnumber">8</span> <span class="toctext">Sample Customised Spreadsheet Format</span></a></li>
<li class='toclevel-1'><a href="Office(xls)_Format.html#Available_Formatting_Options"><span class="tocnumber">9</span> <span class="toctext">Available Formatting Options</span></a>
<ul>
<li class='toclevel-2'><a href="Office(xls)_Format.html#Data_Column_Formats"><span class="tocnumber">9.1</span> <span class="toctext">Data Column Formats</span></a></li>
<li class='toclevel-2'><a href="Office(xls)_Format.html#Data_Column_Formats_-_Text_Wrap"><span class="tocnumber">9.2</span> <span class="toctext">Data Column Formats - Text Wrap</span></a></li>
<li class='toclevel-2'><a href="Office(xls)_Format.html#Library_extension"><span class="tocnumber">9.3</span> <span class="toctext">Library extension</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="Office(xls)_Format.html#System_Notes"><span class="tocnumber">10</span> <span class="toctext">System Notes</span></a></li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Office%28xls%29_Format&amp;action=edit&amp;section=1" title="Edit section: Overview">edit</a>]</div><a name="Overview"></a><h3> Overview </h3>
<p>You can use the xls format functions described below to change the presentation and calculations used in 'Office(xls)' and <a href="Office(xlsx).html" title="Office(xlsx)">Office(xlsx)</a> files.<br />
</p><p>All files are initially formatted using the standard settings. The standard settings are stored in the control <a href="Global_Controls.html#Global_.28GB.29" title="Global Controls"><i>[gb_control]xls_controls</i></a>.<br />  You can update these settings with your own preferred formats.<br />
</p><p>You can customise files created from <a href="./Gb::Queries::executeQueries().html#Parameters" title="Gb::Queries::executeQueries()">scheduler jobs</a> and <a href="Screen_Reports.html" title="Screen Reports">screen reports</a> by adding xls format functions described below to the specific query or report query.<br /> A useful customisation is to embed formulae into your data rows to extend your reporting capabilities. E.g. Financial calculations<br />
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Office%28xls%29_Format&amp;action=edit&amp;section=2" title="Edit section: Standard Settings">edit</a>]</div><a name="Standard_Settings"></a><h3>Standard Settings</h3>
<p>The standard settings usually include the following
</p>
<ol><li> a header section with your company logo
</li><li> a report heading
</li><li> run time information
</li><li> formatted column headings and data rows.
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Office%28xls%29_Format&amp;action=edit&amp;section=3" title="Edit section: Output Change">edit</a>]</div><a name="Output_Change"></a><h3>Output Change</h3>
<p>If an <a href="Office(xlsx).html" title="Office(xlsx)">Office(xlsx)</a> or <strong>Office(xls)</strong> report is generated from one of the locations below, and contain more than 65,500 individual rows, then it will be automatically converted to Text(CSV) format.
</p>
<ol><li> <a href="Reports.html" title="Reports">Fleet / Administration / Reports</a> 
</li><li> <a href="Standard_Reports.html" title="Standard Reports">Reporting / Standard Reports</a> or
</li><li> Scheduler / Job <a href="./Gb::Queries::executeQueries().html" title="Gb::Queries::executeQueries()">executeQuery</a>
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Office%28xls%29_Format&amp;action=edit&amp;section=4" title="Edit section: Creating an Excel Spreadsheet">edit</a>]</div><a name="Creating_an_Excel_Spreadsheet"></a><h3>Creating an Excel Spreadsheet</h3>
<p>To create an Excel spreadsheet using the Catch-e Scheduler, in the Parameters section of the screen, use the 'Attachment Format' dropdown to select 'Office(xls)'.
</p><p><a href="./Image:Office(xls)_Format_1.jpg.html" class="image" title="Image:Office(xls)_Format_1.jpg"><img src="../../clients/help/wiki/images/8/8d/Office(xls)_Format_1.jpg" alt="Image:Office(xls)_Format_1.jpg" width="1009" height="183" longdesc="/mediawiki/index.php/Image:Office%28xls%29_Format_1.jpg" /></a><br /><span class="catch-e_caption"><i><b>Scheduler / Job screen</b></i></span><br /><br />
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Office%28xls%29_Format&amp;action=edit&amp;section=5" title="Edit section: Embedded Formulae">edit</a>]</div><a name="Embedded_Formulae"></a><h3>Embedded Formulae</h3>
<p>You can embed formulae in the spreadsheet using special markup in your SQL.
</p><p>For example, the following SQL contains a formula that multiplies the value in column A with the value in column B:
</p>
<pre>
SELECT finance_pmt_regular AS 'Payment', term AS 'Term', '[formula]=A#row_no# * B#row_no#' AS 'Total Payments'
FROM fm_contracts AS t1
WHERE contract_id = '100001'
</pre>
<p>Notice the use of the marker <span class="catch-e_program_code">[formula]=</span> , this tells the processor that the code following the equals sign is an Excel formula.
</p><p>The placeholder #row_no# is replaced with the current row number transforming,
</p>
<pre>
[formula]=A#row_no# * B#row_no#
</pre>
<p>to
</p>
<pre>
= A6 * B6
</pre>
<p>Here is the resulting spreadsheet:
</p><p><a href="./Image:Office(xls)_Format_4.jpg.html" class="image" title="Image:Office(xls)_Format_4.jpg"><img src="../../clients/help/wiki/images/8/8b/Office(xls)_Format_4.jpg" alt="Image:Office(xls)_Format_4.jpg" width="490" height="170" longdesc="/mediawiki/index.php/Image:Office%28xls%29_Format_4.jpg" /></a>&gt;<br /><span class="catch-e_caption"><b>Sample spreadsheet including resolved formula</b></span><br /><br />
</p><p>It would be possible for you to include values from 'fixed' cells using absoluted cell references.  These cells would have to be in the header section of the report.
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Office%28xls%29_Format&amp;action=edit&amp;section=6" title="Edit section: Default Spreadsheet Formats">edit</a>]</div><a name="Default_Spreadsheet_Formats"></a><h3>Default Spreadsheet Formats</h3>
<p>Unless you specify otherwise, the Excel spreadsheet you create will be formatted according to the default settings for your company, which are set in gb_controls. 
<br />
A report with sample default settings is shown here:<br />
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Office%28xls%29_Format&amp;action=edit&amp;section=7" title="Edit section: Sample Company Default Spreadsheet Format">edit</a>]</div><a name="Sample_Company_Default_Spreadsheet_Format"></a><h4>Sample Company Default Spreadsheet Format</h4>
<ul><li> A Company logo
</li><li> A report title (this is sourced from the field <i>[gb_queries]name</i> )
</li><li> Report generation details&nbsp;: Date, Time, Who ran report
</li><li> A row containing the 'report title', and also the row containing 'Generated by' details, have had their cells 'merged'
</li><li> Column headings with grey background
</li><li> A thin black border around the column heading and data row cells
</li><li> Gridlines turned off
</li><li> First 5 rows 'frozen' so that the column headings will not scroll out of view
</li><li> Column widths set wide enough so dates don't appear as hashes
</li><li> All Cells will be unlocked (editable)
</li></ul>
<p><br />
This will produce an Excel spreadsheet like this:<br />
<br />
<a href="./Image:Office(xls)_Format_2.jpg.html" class="image" title="Image:Office(xls)_Format_2.jpg"><img src="../../clients/help/wiki/images/8/87/Office(xls)_Format_2.jpg" alt="Image:Office(xls)_Format_2.jpg" width="927" height="252" longdesc="/mediawiki/index.php/Image:Office%28xls%29_Format_2.jpg" /></a><br /><span class="catch-e_caption"><i><b>Sample Excel spreadsheet formatted using company defaults</b></i></span><br /><br />
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Office%28xls%29_Format&amp;action=edit&amp;section=8" title="Edit section: Customised Spreadsheet Formats">edit</a>]</div><a name="Customised_Spreadsheet_Formats"></a><h3>Customised Spreadsheet Formats</h3>
<p>For any individual Excel report run from the Catch-e Scheduler, you can override your default company Excel report format.
You do this by specifying the format in a special comment block within the sql. The special comment block can be stored anywhere in the sql (at the top, in the middle, at the bottom - anywhere!).
<br />
Here is a sample to demonstrate customised formatting options:
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Office%28xls%29_Format&amp;action=edit&amp;section=9" title="Edit section: Sample Customised Spreadsheet Format">edit</a>]</div><a name="Sample_Customised_Spreadsheet_Format"></a><h3>Sample Customised Spreadsheet Format</h3>
<ul><li> No header. That is no logo or report header. 
</li><li> Column Heading 'Client Name' has had several styles applied:
</li></ul>
<dl><dd><dl><dd> 'Text Color' is 'White', 'Fill Color' is 'Blue',  'Font Family' is 'Courier New', 'Font Size' is 15.
</dd></dl>
</dd></dl>
<ul><li> Also the heading is split over 2 lines.
</li><li> Each data cell 'Client Name' has these styles applied:
</li></ul>
<dl><dd><dl><dd>'Text Color' is 'Green', 'Font Family' is 'Arial', 'Font Size' is 8, 'Font Style' is 'Bold' and 'Italic'. 
</dd></dl>
</dd></dl>
<ul><li> Column headings with grey background 
</li><li> Gridlines turned on
</li><li> Only the first row is 'frozen' so that the column headings will not scroll out of view.
</li></ul>
<p>Given the default settings in 'Default Spreadsheet Formats', and then applying the customised formatting options, the result is&nbsp;:
<br />
</p><p><a href="./Image:Office(xls)_Format_3.jpg.html" class="image" title="Image:Office(xls)_Format_3.jpg"><img src="../../clients/help/wiki/images/4/40/Office(xls)_Format_3.jpg" alt="Image:Office(xls)_Format_3.jpg" width="932" height="167" longdesc="/mediawiki/index.php/Image:Office%28xls%29_Format_3.jpg" /></a><br /><span class="catch-e_caption"><i><b>Sample Excel spreadsheet using customised formatting</b></i></span><br /><br />
</p><p>Here is an example of the special comment block containing the custom formats:
</p><p><b>Sample comment block containing custom formats</b>
</p>
<pre>
/*
--xls_controls--

// Worksheet settings
$xls_controls['worksheet']['gridlines_flag'] = 'yes';
$xls_controls['worksheet']['freeze_panes'] = 1;
$xls_controls['worksheet']['include_header_flag'] = 'no';

// Column Headings
$xls_controls['column_heading']['formats']['client_name'] = array('text' =&gt; 'Client|Name', 'text_color' =&gt; 'white', 'fill_color' =&gt; 'blue',
'font_family' =&gt; 'Courier  New', 'font_size' =&gt; 15, 'align' =&gt; '');

// Report Rows
$xls_controls['row']['formats']['client_name'] = array('text_color' =&gt; 'green', 'fill_color' =&gt; 'white', 'font_style' =&gt; 'BI', 'column_width' =&gt; 40,
'font_family' =&gt; 'Arial', 'font_size' =&gt; 8, 'align' =&gt; '');

--xls_controls--
*/
</pre>
<p>The custom Excel formatting settings must conform to the following rules.
<br />
</p>
<ol><li> The entire set of rules must be enclosed in a 'comment block'
<dl><dd><dl><dd><dl><dd> starting with&nbsp;: <span class="catch-e_program_code">/*</span>
</dd><dd> and ending with&nbsp;: <span class="catch-e_program_code">*/</span><br /><br />
</dd></dl>
</dd></dl>
</dd></dl>
</li><li> The Excel spreadsheet formatting controls must
<dl><dd><dl><dd><dl><dd>  start with : <span class="catch-e_program_code">--xls_controls--</span>
</dd><dd> and end with : <span class="catch-e_program_code">--xls_controls--</span><br /><br />
</dd></dl>
</dd></dl>
</dd></dl>
</li><li> Blank lines are permitted for readability.<br /><br />
</li><li> Comments, which are indicated by double forward slashes, are ignored when the formatting rules are being processed.  
<dl><dd><dl><dd><dl><dd> <span class="catch-e_program_code">// This is a comment preceded by double forward slashes.</span><br /><br />
</dd></dl>
</dd></dl>
</dd></dl>
</li><li> Each rule commences with the string&nbsp;:  $xls_controls<br /><br />
</li><li> Each rule applies to one of:
<dl><dd><dl><dd><dl><dd> The entire worksheet	:	<span class="catch-e_program_code">$xls_controls['worksheet']</span>
</dd><dd> A report header		:	<span class="catch-e_program_code">$xls_controls['header']</span>
</dd><dd> Column headings		:	<span class="catch-e_program_code">$xls_controls['column_heading']</span>
</dd><dd> Report data ('rows')	:	<span class="catch-e_program_code">$xls_controls['rows']</span><br /><br />
</dd></dl>
</dd></dl>
</dd></dl>
</li><li> Worksheet rules are formatted&nbsp;:  rule = value
<dl><dd><dl><dd><dl><dd> Thus: <span class="catch-e_program_code">$xls_controls['worksheet']['gridlines_flag'] = 'yes';</span> tells the processor to produce the spreadsheet with grid lines.<br /><br />
</dd></dl>
</dd></dl>
</dd></dl>
</li><li> Data values from your report can be placed in Header rows, or Column heading rows, by using place-holders. Place-holders are enclosed between '#' signs.  For example: #client_name#.  Place-holders are replaced when the spreadsheet is produced.<br /><br />
</li><li> You can also use any of these specific place-holders:   <span class="catch-e_program_code">#report_title#   #run_date#   #run_time#   #run_user#</span><br /><br />
</li><li> To set a date or currency format for given column(s), add a 'format' e.g.
<dl><dd>'format' =&gt; '[$$-C09]#,##0.00;[RED]-[$$-C09]#,##0.00'
</dd><dd>'format' =&gt; 'DD-MM-YYYY'
<dl><dd><dl><dd> <span class="catch-e_program_code"> $xls_controls['row']['formats']['list_price_net'] = array('data_type' =&gt; 'number', 'format' =&gt; '[$$-C09]#,##0.00;[RED]-[$$-C09]#,##0.00', 'column_width' =&gt; 20);</span>
</dd><dd><span class="catch-e_program_code"> $xls_controls['row']['formats']['quote_date'] = array('data_type' =&gt; 'date_mysql', 'format' =&gt; 'DD-MM-YYYY', 'column_width' =&gt; 20);</span> 
</dd></dl>
</dd></dl>
</dd><dd> Note: Although you don't have to set the 'data_type' property, it is a good idea to do this when dealing with numeric / date columns.The 'data_type' describes the input data. Values for 'data_type' can be: number, text, date or date_mysql
</dd></dl>
</li><li> 'Column Heading' formats and 'Row Formats' are applied to individual columns using format =&gt; value pairs enclosed in brackets.
<dl><dd> Thus:
<dl><dd><dl><dd> <span class="catch-e_program_code">$xls_controls['row']['formats']['client_name'] = array('text_color' =&gt; 'green', 'fill_color' =&gt; 'white', 'font_style' =&gt; 'BI', 'column_width' =&gt; 40, 'font_family' =&gt; 'Arial', 'font_size' =&gt; 8, 'align' =&gt; 'C');</span>
</dd></dl>
</dd></dl>
</dd><dd>is interpreted by the processor as&nbsp;:
</dd></dl>
</li></ol>
<table class="catch-e" style="border-collapse: collapse; width: 80%;">
<tr>
<th> Rule </th><th> Effect
</th></tr>
<tr>
<td width="25%" align="left"> $xls_controls['row']['formats']	</td><td width="75%" align="left"> All rows of data will be affected by these format rules
</td></tr>
<tr>
<td> ['client_name']</td><td> Column 'client_name' will be affected by these rules
</td></tr>
<tr>
<td>'text_color' =&gt; 'green'</td><td> Font Colour will be green.
</td></tr>
<tr>
<td> 'fill_color' =&gt; 'white'</td><td> Background Colour will be white
</td></tr>
<tr>
<td>'font_style' =&gt; 'BI'</td><td> The Font will be both Bold and Italic
</td></tr>
<tr valign="top">
<td>'column_width' =&gt; 40</td><td> Use this rule to affect the default width of cells.<br />
<p>The default Excel column width will typically not display an entire name or description.  A little trial and error should produce your required result.  For those technically interested,  <a href="http://support.microsoft.com/kb/214123" class='external text' title="http://support.microsoft.com/kb/214123" rel="nofollow">click here</a>.
</p>
</td></tr>
<tr>
<td>'font_family' =&gt; 'Arial'</td><td> Font will be Arial
</td></tr>
<tr>
<td>'font_size' =&gt; 8</td><td> Font Size will be 8 points
</td></tr>
<tr>
<td>'align' =&gt; 'C'</td><td> Alignment is Centred
</td></tr></table>
<p><br />
<ol start="12">
</p>
<li>You need only specify formats you want to change from the defaults.  For example: if you want a different font_size, but are happy with your company's default text colour, you can specify: <span class="catch-e_program_code">['font_size'] =&gt; 25</span>, but you do not need to specify the 'text_color' parameter.</li>
<p><br />
</p>
<li>All rules must end with a semi-colon.</li>
<p></ol>
<br />
</p>
<table style="border-collapse: collapse; width: 100%; background: #ffd7d7; border: 1px solid silver;">

<tr>
<td width="15%" align="left"> <a href="./Image:Warning.png.html" class="image" title=""><img src="../../clients/help/wiki/images/c/cb/Warning.png" alt="" width="30" height="30" longdesc="/mediawiki/index.php/Image:Warning.png" /></a> &nbsp;&nbsp;If you fail to follow these rules, the system will not give you any warning, it will simply ignore your settings, and use the defaults instead. You can check your formats using this this online tool <a href="https://demo.catch-e.net.au/utils/code_checker.phpo" class='external text' title="https://demo.catch-e.net.au/utils/code_checker.phpo" rel="nofollow">Code Checker</a>
</td></tr></table>
<p><br />
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Office%28xls%29_Format&amp;action=edit&amp;section=10" title="Edit section: Available Formatting Options">edit</a>]</div><a name="Available_Formatting_Options"></a><h3>Available Formatting Options</h3>
<p>The complete list of formatting options available, and the default settings, are listed here.<br />
</p>
<table class="catch-e" style="border-collapse: collapse; width: 80%;">

<tr valign="top">
<th> Worksheet <a href="Global_Controls.html#Global_.28GB.29" title="Global Controls">gb_controls</a> Default Settings (unless amended by your company)
</th><th> Notes
</th></tr>
<tr valign="top">
<td> <span class="catch-e_program_code">$xls_controls['worksheet']['name'] = '';</span>
</td><td> Only one worksheet can be produced. Unless specified, your worksheet will be named by the Excel default 'Sheet1'.
</td></tr>
<tr valign="top">
<td> <span class="catch-e_program_code">$xls_controls['worksheet']['gridlines_flag'] = 'no';</span>
</td><td> To display gridlines, set to 'yes'.
</td></tr>
<tr valign="top">
<td> <span class="catch-e_program_code">$xls_controls['worksheet']['freeze_panes'] = 5;</span>
</td><td> Specify number of rows to be frozen. This is the number of rows which will never disappear from view when you scroll the spreadsheet. Can be set to zero.
</td></tr>
<tr valign="top">
<td> <span class="catch-e_program_code">$xls_controls['worksheet']['include_header_flag'] = 'yes';</span>
</td><td> If set to 'no', no header lines or company logo are placed at the top of the spreadsheet.
</td></tr>
<tr valign="top">
<td> <span class="catch-e_program_code">$xls_controls['worksheet']['landscape_flag'] = 'yes';</span>
</td><td> For a 'portrait' spreadsheet, set to 'no'.
</td></tr>
<tr valign="top">
<td> <span class="catch-e_program_code">$xls_controls['worksheet']['paper_type'] = 9;</span>
</td><td> 9 = A4 1 = US letter
</td></tr>
<tr valign="top">
<td> <span class="catch-e_program_code">$xls_controls['worksheet']['protect'] = 'a1B2c3D4';</span>
</td><td> Substitute 'a1B2c3D4' with your own password. The sheet can be unlocked later if you know the password.<br />
<ul><li>If you have a logo on the report it will not be locked by this control. I.e. the logo can be moved or deleted from the worksheet even whilst locked.
</li></ul>
</td></tr>
<tr valign="top">
<th colspan="2"> Header Section <a href="Global_Controls.html#Global_.28GB.29" title="Global Controls">gb_controls</a> Default Settings (unless amended by your company)
</th></tr>
<tr valign="top">
<td> <span class="catch-e_program_code">$xls_controls['header'][1] ...</span>
</td><td> For the header section, you specify controls for each row. The row number is the next parameter after '<span class="catch-e_program_code">$xls_controls['header']'</span> . <span class="catch-e_program_code">[1]</span> indicates the first row of the spreadsheet, <span class="catch-e_program_code">[2]</span> the second row etc.
</td></tr>
<tr valign="top">
<td>
<p><span class="catch-e_program_code">$xls_controls['header'][1]['bitmap'] = ...</span><br />
<span class="catch-e_program_code">$xls_controls['header'][3]['value'] = ...</span><br />
<span class="catch-e_program_code">$xls_controls['header'][3]['formats'] = ...</span>
</p>
</td><td>
<p>Following the row number is either:<br /><span class="catch-e_program_code">['bitmap']</span>&nbsp;: specifies a company logo anchored to this header row<br /><span class="catch-e_program_code">['value']</span>&nbsp;: specifies what text is displayed in this header row<br /><span class="catch-e_program_code">['formats'] </span>: specifies what formats are applied to this header row.
</p>
</td></tr>
<tr valign="top">
<td> <span class="catch-e_program_code">$xls_controls['header'][1]['bitmap'] = array('filename' =&gt; 'logo.bmp', 'height' =&gt; 75);</span>
</td><td> <span class="catch-e_program_code">'filename'</span> is the file to be used as your company logo. It must exist in the relevant directory, and must have a '.bmp' extension. The row height is set so the image occupies exactly one row. The optional <span class="catch-e_program_code">'height'</span> parameter, can be used to change the height of the image. The image width will then be scaled to maintain the same aspect ratio.
</td></tr>
<tr valign="top">
<td> <span class="catch-e_program_code">$xls_controls['header'][3]['value'] = '#report_title#';</span>
</td><td> By default, the report title appears in the third row of your speadsheet. If you specify <span class="catch-e_program_code">#report_title#</span>, the default report title is derived from the name you give your query (gb_queries.name).
</td></tr>
<tr valign="top">
<td> <span class="catch-e_program_code">$xls_controls['header'][3]['formats'] = array('border_color' =&gt; 'black', 'border' =&gt; '0', 'row_height' =&gt; '14', 'merge_cells' =&gt; '0,5', 'font_family' =&gt; 'Calibri', 'font_size' =&gt; 16, 'align' =&gt; 'L', 'text_color' =&gt; 'black', 'fill_color' =&gt; 'white', 'font_style' =&gt; 'B');</span>
</td><td>
<p>Cell formats for row <span class="catch-e_program_code">[3]</span>.  Formats are explained elsewhere in this documentation and are self-explanatory, except for <span class="catch-e_program_code">'merge_cells' =&gt; '0,5'</span>.<br />
<span class="catch-e_program_code">'merge_cells'</span>&nbsp;: allows you to merge header cells for the specified row, by specifying start and end columns. In the example on the left, cells in row 3 of the spreadsheet, will have columns <span class="catch-e_program_code">'0,5'</span> that is columns zero to five merged. When you open your spreadsheet, these six columns are identified in Excel as&nbsp;: 'A', 'B, 'C', 'D', 'E' and 'F'.
</p>
</td></tr>
<tr valign="top">
<td> <span class="catch-e_program_code">$xls_controls['header'][4]['value'] = 'Generated: #run_date# at #run_time# by #run_user#';</span>
</td><td> Default row <span class="catch-e_program_code">[4]</span>.
</td></tr>
<tr valign="top">
<td> <span class="catch-e_program_code">$xls_controls['header'][4]['formats'] = array('border_color' =&gt; 'black', 'border' =&gt; '0', 'merge_cells' =&gt; '0,5', 'font_family' =&gt; 'Calibri', 'font_size' =&gt; 9, 'align' =&gt; 'L', 'text_color' =&gt; 'black', 'fill_color' =&gt; 'white', 'font_style' =&gt; '');</span>
</td><td> Default row <span class="catch-e_program_code">[4]</span> cell formats.
</td></tr>
<tr valign="top">
<th colspan="2"> Column Heading <a href="Global_Controls.html#Global_.28GB.29" title="Global Controls">gb_controls</a> Section Default Settings (unless amended by your company)
</th></tr>
<tr valign="top">
<td height="94">
<p><span class="catch-e_program_code">$xls_controls['column_heading']['formats']['font_family']='Calibri';</span><br />
<span class="catch-e_program_code">$xls_controls['column_heading']['formats']['font_size'] = 10;</span><br />
<span class="catch-e_program_code">$xls_controls['column_heading']['formats']['text_color'] = 'black';</span><br />
<span class="catch-e_program_code">$xls_controls['column_heading']['formats']['fill_color'] = 'silver';</span><br />
<span class="catch-e_program_code">$xls_controls['column_heading']['formats']['align'] = 'L';</span><br />
<span class="catch-e_program_code">$xls_controls['column_heading']['formats']['valign'] = 'top';</span><br />
<span class="catch-e_program_code">$xls_controls['column_heading']['formats']['font_style'] = '';</span><br />
<span class="catch-e_program_code">$xls_controls['column_heading']['formats']['border_color']='black';</span><br />
<span class="catch-e_program_code">$xls_controls['column_heading']['formats']['border'] = '1';</span><br />
<span class="catch-e_program_code">$xls_controls['column_heading']['formats']['row_height'] = '30';</span><br />
<span class="catch-e_program_code">$xls_controls['column_heading']['formats']['text_wrap'] = '1';</span>
</p>
</td><td>
<p>Alternative syntax for the <span class="catch-e_program_code">$xls_controls['column_heading']['formats']</span>is shown immediately below.
</p>
</td></tr>
<tr valign="top">
<td colspan="2"> <span class="catch-e_program_code">$xls_controls['column_heading']['formats'] = array('font_family' =&gt; 'Calibri', 'font_size' =&gt; 10, 'text_color' =&gt; 'black', 'fill_color' =&gt; 'silver', 'align' =&gt; 'L', 'font_style' = '', 'border_color' = 'black', 'border' = '1');</span>
</td></tr>
<tr valign="top">
<td> <span class="catch-e_program_code">$xls_controls['column_heading']['formats']['client_name'] = (array('text' =&gt; 'Client|Name', 'font_family'] =&gt; 'Calibri', 'font_size' =&gt; 10, 'text_color' =&gt; 'black', 'fill_color' =&gt; 'silver', 'align' =&gt; 'L', 'font_style' = '', 'border_color' = 'black', 'border' = '1');</span>
</td><td>
<p>Column Heading formats may also be specified for specific columns. In the example, the column is 'client_name'&nbsp;: <span class="catch-e_program_code">$xls_controls['column_heading']['formats']['client_name']</span><br />
Note the optional use of the '|' character in the Column Heading 'text' parameter <span class="catch-e_program_code">'Client|Name'</span>, which indicates the words 'Client' and 'Name' will appear on separate lines in the Column Heading cell.
</p>
</td></tr>
<tr valign="top">
<th colspan="2"> Data Row Section <a href="Global_Controls.html#Global_.28GB.29" title="Global Controls">gb_controls</a> Default Settings (unless amended by your company)
</th></tr>
<tr valign="top">
<td>
<p><span class="catch-e_program_code">$xls_controls ['row']['formats']['font_family'] = 'Arial';</span><br />
<span class="catch-e_program_code">$xls_controls ['row']['formats']['font_size'] = 10;</span><br />
<span class="catch-e_program_code">$xls_controls ['row']['formats']['text_color'] = 'black';</span><br />
<span class="catch-e_program_code">$xls_controls ['row']['formats']['fill_color'] = 'white';</span><br />
<span class="catch-e_program_code">$xls_controls ['row']['formats']['align'] = 'L';</span><br />
<span class="catch-e_program_code">$xls_controls ['row']['formats']['font_style'] = '';</span><br />
</p>
</td><td> Default data row cell formats.
</td></tr>
<tr valign="top">
<td> <span class="catch-e_program_code">$xls_controls[['row']]['formats']['client_name'] =&gt; ('font_family' =&gt; 'Arial', 'font_size' =&gt; 10, 'text_color' =&gt; 'black', 'fill_color' =&gt; 'white', 'align' =&gt; 'L', 'column_width' =&gt; 20);</span>
</td><td> Similarly to Column Heading formats, Data Row formats may also be specified for specific columns. In this example&nbsp;: <span class="catch-e_program_code">$xls_controls['row']['formats']['client_name']</span>
</td></tr></table>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Office%28xls%29_Format&amp;action=edit&amp;section=11" title="Edit section: Data Column Formats">edit</a>]</div><a name="Data_Column_Formats"></a><h4>Data Column Formats</h4>
<p>'format' =&gt; '$#.#;[Red]($#.#)'<br />
'format' =&gt; 'DD-MM-YYYY'
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Office%28xls%29_Format&amp;action=edit&amp;section=12" title="Edit section: Data Column Formats - Text Wrap">edit</a>]</div><a name="Data_Column_Formats_-_Text_Wrap"></a><h4>Data Column Formats - Text Wrap</h4>
<p>The format below is to wrap text for a column
</p>
<pre>
/*
--xls_controls--
$xls_controls['row']['formats']['Order Status Comment'] = array('column_width' =&gt; 40, 'text_wrap' =&gt; '1');
--xls_controls--
*/
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Office%28xls%29_Format&amp;action=edit&amp;section=13" title="Edit section: Library extension">edit</a>]</div><a name="Library_extension"></a><h4>Library extension</h4>
<p>Xls library extends <a href="https://pear.php.net/manual/en/package.fileformats.spreadsheet-excel-writer.intro.php" class='external text' title="https://pear.php.net/manual/en/package.fileformats.spreadsheet-excel-writer.intro.php" rel="nofollow">Spreadhseet Excel Writer</a>. All available formatting options from the library can be used.
</p><p><br />
</p>
<hr />
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Office%28xls%29_Format&amp;action=edit&amp;section=14" title="Edit section: System Notes">edit</a>]</div><a name="System_Notes"></a><h3>System Notes</h3>
<p><small>
</p>
<ul><li> 5757: Enable extended number formats such as currency. Live 27/08/2012
</li><li> 4141: XLS reporting bugs: 1. Customising Header Line. 2. queries.phpo. Live 01/02/2013
</li><li> 8614: XLS Controls - Lock spreadsheet. Live xx/10/2013
</li><li> (DEV-22122) Increase the colour palette for excel scheduled reports. Live xx/xx/2024
</li></ul>
<p></small>
</p><div class="printfooter">
Retrieved from "<a href="Office(xls)_Format.html">https://help.catch-e.net.au/mediawiki/index.php/Office%28xls%29_Format</a>"</div>
						<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<ul>
		</ul>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="https://help.catch-e.net.au/mediawiki/index.php?title=Special:Userlogin&amp;returnto=Office(xls)_Format">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(../../clients/help/wiki/common/images/logo.gif);" href="Main_Page.html" title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="./Special:Search.html" id="searchform"><div>
				<input id="searchInput" name="search" type="text" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" value="Search" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="./Special:Whatlinkshere/Office(xls)_Format.html">What links here</a></li>
				<li id="t-print"><a href="https://help.catch-e.net.au/mediawiki/index.php?title=Office%28xls%29_Format&amp;printable=yes">Printable version</a></li>			</ul>
		</div>
	</div>

		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../skins/common/images/poweredby_mediawiki_88x31.png" alt="MediaWiki" /></a></div>
&copy; 2025 Catch-e Pty Ltd			<ul id="f-list">
				<li id="privacy"><a href="./Help_wiki:Privacy_policy.html" title="Help wiki:Privacy policy">Privacy policy</a></li>
				<li id="disclaimer"><a href="./Help_wiki:General_disclaimer.html" title="Help wiki:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
	<script type="text/javascript"> if (window.runOnloadHook) runOnloadHook();</script>
</div>
<!-- Served by 2c88f4f4aa65 in 0.12 secs. -->
</body></html>
