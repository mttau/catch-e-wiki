<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="keywords" content="Finalise,Account Manager,Administration,Billing,Contracts,Contracts:Lease,Credit Notes,FLEET,Finalise a vehicle contract,Funds Check,Funds Check Setup" />
<link rel="shortcut icon" href="../../favicon.ico" />
		<title>Finalise - Help wiki</title>
		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "../skins/catche/main.css%3F7.css"; /*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print" href="../skins/common/commonPrint.css" />
		<!--[if lt IE 5.5000]><style type="text/css">@import "/mediawiki/skins/catche/IE50Fixes.css";</style><![endif]-->
		<!--[if IE 5.5000]><style type="text/css">@import "/mediawiki/skins/catche/IE55Fixes.css";</style><![endif]-->
		<!--[if IE 6]><style type="text/css">@import "/mediawiki/skins/catche/IE60Fixes.css";</style><![endif]-->
		<!--[if IE 7]><style type="text/css">@import "/mediawiki/skins/catche/IE70Fixes.css?1";</style><![endif]-->
		<!--[if lt IE 7]><script type="text/javascript" src="/mediawiki/skins/common/IEFixes.js"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
		<script type="text/javascript">var skin = 'catche';var stylepath = '/mediawiki/skins';</script>
		<script type="text/javascript" src="../skins/common/wikibits.js"><!-- wikibits js --></script>
		<script type="text/javascript" src="../index.php%3Ftitle=-&amp;action=raw&amp;gen=js"><!-- site js --></script>
		<style type="text/css">/*<![CDATA[*/
@import "../index.php%3Ftitle=MediaWiki:Common.css&action=raw&ctype=text%252Fcss&smaxage=18000.css";
@import "../index.php%3Ftitle=MediaWiki:Catche.css&action=raw&ctype=text%252Fcss&smaxage=18000.css";
@import "../index.php%3Ftitle=-&action=raw&gen=css&maxage=18000.css";
/*]]>*/</style>
		<!-- Head Scripts -->
		      <style>
        <!--
        .editsection { display: none; }
        -->
      </style>
	</head>
<body  class="ns-0 ltr">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 class="firstHeading">Finalise</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Help wiki</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="Finalise.html#column-one">navigation</a>, <a href="Finalise.html#searchInput">search</a></div>			<!-- start content -->
			<p><a href="Main_Page.html" title="Main Page">Main Page</a> &rarr; <a href="FLEET.html" title="FLEET">Fleet</a> / <a href="Administration.html" title="Administration">Administration</a> / <a href="Contracts.html" title="Contracts">Contracts</a>  &rarr; <a href="./Contracts:Lease.html#Action_Buttons" title="Contracts:Lease">Lease</a> &rarr; <strong>Finalise</strong>
</p>
<hr />
<p><br />
</p>
<table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class='toclevel-1'><a href="Finalise.html#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a></li>
<li class='toclevel-1'><a href="Finalise.html#Process_Pages"><span class="tocnumber">2</span> <span class="toctext">Process Pages</span></a></li>
<li class='toclevel-1'><a href="Finalise.html#Report_Map"><span class="tocnumber">3</span> <span class="toctext">Report Map</span></a></li>
<li class='toclevel-1'><a href="Finalise.html#Enable_rules"><span class="tocnumber">4</span> <span class="toctext">Enable rules</span></a></li>
<li class='toclevel-1'><a href="Finalise.html#Invoicing_a_Final_Lease_Period_record"><span class="tocnumber">5</span> <span class="toctext">Invoicing a Final Lease Period record</span></a></li>
<li class='toclevel-1'><a href="Finalise.html#Troubleshooting"><span class="tocnumber">6</span> <span class="toctext">Troubleshooting</span></a>
<ul>
<li class='toclevel-2'><a href="Finalise.html#The_Finalise_button_is_disabled"><span class="tocnumber">6.1</span> <span class="toctext">The Finalise button is disabled</span></a>
<ul>
<li class='toclevel-3'><a href="Finalise.html#Enable_rules_2"><span class="tocnumber">6.1.1</span> <span class="toctext">Enable rules</span></a></li>
</ul>
</li>
</ul>
</li>
<li class='toclevel-1'><a href="Finalise.html#Set-up_Notes"><span class="tocnumber">7</span> <span class="toctext">Set-up Notes</span></a></li>
<li class='toclevel-1'><a href="Finalise.html#Useful_Queries"><span class="tocnumber">8</span> <span class="toctext">Useful Queries</span></a></li>
<li class='toclevel-1'><a href="Finalise.html#System_Notes"><span class="tocnumber">9</span> <span class="toctext">System Notes</span></a></li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Finalise&amp;action=edit&amp;section=1" title="Edit section: Overview">edit</a>]</div><a name="Overview"></a><h4>Overview</h4>
<p>If this feature is configured and the conditions below are met, the <b>Finalise</b> button will be enabled.<br />
When you click on <b>Finalise</b> a pending record is created that contains budget amounts that will result in all of the budget and actual categories being the same amount (I.e. a 0 variance).<br /> 
You can then review this record and use the <u>Invoice Now</u> hyperlink to navigate to a <a href="Billing.html#Suspended_Contracts" title="Billing">Billing screen</a> and post it.
</p>
<table style="border-collapse: collapse; width: 100%; border: 1px solid silver;">

<tr>
<td width="50px" align="left"> <a href="./Image:Info.png.html" class="image" title=""><img src="../../clients/help/wiki/images/b/b3/Info.png" alt="" width="30" height="30" longdesc="/mediawiki/index.php/Image:Info.png" /></a></td><td align="left">The <b>Finalise</b> button is designed for end of lease processing for <a href="Novated.html" title="Novated">Novated</a> contracts and is <u>not</u> recommended for other contract groups.
</td></tr></table>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Finalise&amp;action=edit&amp;section=2" title="Edit section: Process Pages">edit</a>]</div><a name="Process_Pages"></a><h4>Process Pages</h4>
<p><a href="Finalise_a_vehicle_contract.html" title="Finalise a vehicle contract">Finalise a vehicle contract</a>
<br />
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Finalise&amp;action=edit&amp;section=3" title="Edit section: Report Map">edit</a>]</div><a name="Report_Map"></a><h4>Report Map</h4>
<p>The <b>Finalise</b> button should be used in conjunction with the <a href="Funds_Check.html" title="Funds Check">Funds Check</a> pop-up. They both need a <a href="Funds_Check_Setup.html#Report_Map" title="Funds Check Setup">report map</a> set-up to work. This links each Posting Class to a Category.<br /> 
The <a href="Funds_Check_Setup.html#Report_Map" title="Funds Check Setup">report map</a> is also used by;
</p>
<ol><li> The <a href="Transactions_Report_Setup.html" title="Transactions Report Setup">Transactions Report</a>
</li><li> The <a href="Vehicle_Balance_with_Transactions.html" title="Vehicle Balance with Transactions">Driver Portal - Vehicle Balance with Transactions</a> screen
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Finalise&amp;action=edit&amp;section=4" title="Edit section: Enable rules">edit</a>]</div><a name="Enable_rules"></a><h4>Enable rules</h4>
<ol><li> The contract belongs to the 'Novated' group.
</li><li> A "<a href="Suspend_Date.html" title="Suspend Date">Suspend Date</a>" has been entered on the contract.
</li><li> There are no transactions in 'Pending' or 'On Hold' status in the Payments and Maintenance tabs.
</li><li> At least one period has been billed.
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Finalise&amp;action=edit&amp;section=5" title="Edit section: Invoicing a Final Lease Period record">edit</a>]</div><a name="Invoicing_a_Final_Lease_Period_record"></a><h4>Invoicing a Final Lease Period record</h4>
<ul><li> Invoice a final record from the Contracts / Lease tab immediately by clicking on the <u>Invoice Now</u> hyperlink.  
</li><li> The <u>Invoice Now</u> hyperlink should always work because the billing_date of the record is created as the contract’s "<a href="Suspend_Date.html" title="Suspend Date">Suspend Date</a>": less one day. E.g. if the "Suspend Date" = '14/05/2019', the billing_date will be '13/05/2019'. 
</li><li> The <u>Invoice Now</u> hyperlink functionality will navigate as normal, so if the client’s “Billing Type” = ‘Combined’, navigate the user to the Combined Billing screen when the hyperlink is clicked, otherwise you will be navigated to the Periodic Billing screen.
</li><li> If you choose not to <u>Invoice Now</u>, this final record will form part of the standard data selection for the Combined and Periodic billing screens. I.e. they become part of the next combined or periodic invoice if the date falls with in the invoicing selections.
</li><li> If the finalise record results in a negative value ( i.e. a credit), it is treated as an adjustment and does not generate as a <a href="Credit_Notes.html" title="Credit Notes">credit note</a> even if your system is configured to do this.
</li><li>If the Budget group is linked to a record where <i>[gl_reporting_groups]report_budget_as_actual = ‘yes’ </i> there will be no variance to process as the Actual is a mirror of Budget values.
</li></ul>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Finalise&amp;action=edit&amp;section=6" title="Edit section: Troubleshooting">edit</a>]</div><a name="Troubleshooting"></a><h4>Troubleshooting</h4>
<table style="border-collapse: collapse; width: 100%; border: 1px solid silver;">

<tr>
<td width="50px" align="left"> <a href="./Image:Tip.png.html" class="image" title=""><img src="../../clients/help/wiki/images/4/45/Tip.png" alt="" width="30" height="30" longdesc="/mediawiki/index.php/Image:Tip.png" /></a></td><td align="left">Visit the main <a href="Troubleshooting.html#Contracts_.2F_Lease" title="Troubleshooting">Troubleshooting</a> page for a list of all the available problem-solving tips.
</td></tr></table>
<p><br />
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Template:Contracts:Lease:Finalise&amp;action=edit&amp;section=1" title="Template:Contracts:Lease:Finalise">edit</a>]</div><a name="The_Finalise_button_is_disabled"></a><h5>The <strong>Finalise</strong> button is disabled</h5>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Template:Contracts:Lease:Finalise&amp;action=edit&amp;section=2" title="Template:Contracts:Lease:Finalise">edit</a>]</div><a name="Enable_rules_2"></a><h6>Enable rules</h6>
<ol><li> The contract belongs to the 'Novated' group.
</li><li> A "<a href="Suspend_Date.html" title="Suspend Date">Suspend Date</a>" has been entered on the contract.
</li><li> There are no transactions in 'Pending' or 'On Hold' status in the Payments and Maintenance tabs.
</li><li> At least one period has been billed.
</li></ol>
<p>Even if all the conditions for using the Finalise button have been met, sometimes required data is missing if the contract has been migrated into the Catch-e System.<br />
In these situations, the <strong>Finalise</strong> feature cannot be used and you will need to finalise the contract manually.
<br />
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Finalise&amp;action=edit&amp;section=7" title="Edit section: Set-up Notes">edit</a>]</div><a name="Set-up_Notes"></a><h4>Set-up Notes</h4>
<p>Contact your <a href="Account_Manager.html" title="Account Manager">Account Manager</a> and advise 
</p>
<ol><li> which Contract Types you would like to use the <b>Finalise</b> button on
</li><li> Which Roles should have access to use the <b>Finalise</b> button
</li></ol>
<p>Your <a href="Account_Manager.html" title="Account Manager">Account Manager</a> will arrange the following updates:
</p>
<ol><li> Review or add a suitable <a href="Funds_Check.html#Report_Map" title="Funds Check">report map</a>
</li><li> Add an entry into the <i>[gl_posting_map_reporting]</i> table for each Contract Type that should have the <b>Finalise</b> button. The <i>[gl_posting_map_reporting]type</i> = 'lease_finalise'
</li><li> Review the records in <i>[gl_reporting_class_maps]</i> and set <i>[gl_reporting_class_maps]finalise_flag</i> = 'yes' for one posting class per category. This is the posting class that will be used to create a billing budget row for that category.
</li><li> Check and update the <a href="./Role_Restrictions:Contracts.html#Lease" title="Role Restrictions:Contracts">Role Restriction</a> settings. Role access to the Finalise button can be added and removed. By default, only the 'Admin' role has access to this button.
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Finalise&amp;action=edit&amp;section=8" title="Edit section: Useful Queries">edit</a>]</div><a name="Useful_Queries"></a><h4>Useful Queries</h4>
<pre>
# Check which category is mapped to which posting class (should be 1:1)
SELECT rm.description AS report_map,rg.name AS category,pc.posting_class_code AS class_code,pc.name AS class_name
FROM gl_reporting_groups AS rg 
LEFT JOIN gl_reporting_class_maps AS rcm ON rg.reporting_group_id = rcm.reporting_group_id AND rcm.finalise_flag = 'yes'
LEFT JOIN gl_reporting_maps AS rm ON rm.reporting_map_id = rcm.reporting_map_id
LEFT JOIN gl_posting_classes AS pc ON pc.posting_class_id = rcm.posting_class_id
;

# Contract Type - check which types have the button added (should only be novated)
SELECT pm.posting_map_id, pm.posting_map_code,pm.posting_map_group,rm.description AS report_map,pmr.type
FROM gl_posting_maps AS pm 
INNER JOIN gl_posting_map_reporting AS pmr ON pm.posting_map_id = pmr.posting_map_id
INNER JOIN gl_reporting_maps AS rm ON rm.reporting_map_id = pmr.reporting_map_id
WHERE pmr.type = 'lease_finalise'
ORDER BY pm.posting_map_code,rm.description,pmr.type
;
# Contract Type - check each reporting group is mapped to a posting class and it's in the accrual tab (should be 1:1)
SELECT pm.posting_map_group,pm.posting_map_code,pcm.category_type,rm.description as report_map,rg.name as category,rg.report_budget_as_actual,COUNT(pcm.posting_class_id) AS joins
FROM gl_reporting_groups AS rg
INNER JOIN gl_reporting_class_maps AS rcm ON rcm.reporting_group_id = rg.reporting_group_id  AND rcm.finalise_flag = 'yes'
INNER JOIN gl_posting_map_reporting AS pmr ON pmr.reporting_map_id = rcm.reporting_map_id AND pmr.type = 'lease_finalise'
INNER JOIN gl_reporting_maps AS rm ON rm.reporting_map_id = pmr.reporting_map_id
INNER JOIN gl_posting_maps AS pm ON pm.posting_map_id = pmr.posting_map_id AND pm.posting_map_group = 'novated'
LEFT JOIN gl_posting_class_maps AS pcm ON pcm.posting_map_id = pm.posting_map_id AND pcm.posting_class_id = rcm.posting_class_id AND pcm.category_type = 'accrual'
GROUP BY rg.name,pm.posting_map_id
ORDER BY pm.posting_map_code ,rg.reporting_group_id
;
# Show each map, group and class with finalise_flag
select rcm.*, pc.posting_class_code 
from gl_reporting_class_maps as rcm
inner join gl_posting_classes as pc on pc.posting_class_id = rcm.posting_class_id
order by rcm.reporting_group_id, rcm.finalise_flag DESC, pc.posting_class_code
;
# Detail of which posting class will be used to create the fm_contract_budget record (detail)
SELECT pm.posting_map_group,pm.posting_map_code,rm.description as report_map,rg.name AS category,pcm.category_type,pc.posting_class_code, pc.name
FROM gl_reporting_groups AS rg
LEFT JOIN gl_reporting_class_maps AS rcm ON rcm.reporting_group_id = rg.reporting_group_id AND rcm.finalise_flag = 'yes'
LEFT JOIN gl_posting_map_reporting AS pmr ON pmr.reporting_map_id = rcm.reporting_map_id AND pmr.type = 'lease_finalise'
LEFT JOIN gl_reporting_maps AS rm ON rm.reporting_map_id = pmr.reporting_map_id
LEFT JOIN gl_posting_maps AS pm ON pm.posting_map_id = pmr.posting_map_id AND pm.posting_map_group = 'novated'
LEFT JOIN gl_posting_class_maps AS pcm ON pcm.posting_map_id = pm.posting_map_id AND pcm.posting_class_id = rcm.posting_class_id AND pcm.category_type = 'accrual'
LEFT JOIN gl_posting_classes AS pc ON pc.posting_class_id = pcm.posting_class_id
ORDER BY pm.posting_map_code,rm.description,rg.reporting_group_id, pc.posting_class_code
;
# Finalise button is hidden if their is a restriction with a bit_array of '71'
select r.name, rr.*
from gb_roles as r
left join gb_role_restrictions as rr on r.role_id = rr.role_id and module = 'fm' AND page = 'contracts' AND sub_page = 'lease' AND type = 'bottom_controls_map'
order by role_id
;
</pre>
<p><br />
</p>
<hr />
<div class="editsection" style="float:right;margin-left:5px;">[<a href="https://help.catch-e.net.au/mediawiki/index.php?title=Finalise&amp;action=edit&amp;section=9" title="Edit section: System Notes">edit</a>]</div><a name="System_Notes"></a><h4>System Notes</h4>
<p><small>
</p>
<ul><li> (DEV-20730) Automate final billing process for suspended contracts. Live 20/04/2020
</li><li> (API-20054) Final process does not respect [gl_reporting_groups]report_budget_as_actual. Live 10/08/2020
</li><li> (DEV-21205) Create permissions for use of Finalise Feature. Live 05/10/2020
</li></ul>
<p></small>
</p><div class="printfooter">
Retrieved from "<a href="Finalise.html">https://help.catch-e.net.au/mediawiki/index.php/Finalise</a>"</div>
						<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<ul>
		</ul>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="https://help.catch-e.net.au/mediawiki/index.php?title=Special:Userlogin&amp;returnto=Finalise">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(../../clients/help/wiki/common/images/logo.gif);" href="Main_Page.html" title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="./Special:Search.html" id="searchform"><div>
				<input id="searchInput" name="search" type="text" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" value="Search" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="./Special:Whatlinkshere/Finalise.html">What links here</a></li>
				<li id="t-print"><a href="https://help.catch-e.net.au/mediawiki/index.php?title=Finalise&amp;printable=yes">Printable version</a></li>			</ul>
		</div>
	</div>

		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../skins/common/images/poweredby_mediawiki_88x31.png" alt="MediaWiki" /></a></div>
&copy; 2025 Catch-e Pty Ltd			<ul id="f-list">
				<li id="privacy"><a href="./Help_wiki:Privacy_policy.html" title="Help wiki:Privacy policy">Privacy policy</a></li>
				<li id="disclaimer"><a href="./Help_wiki:General_disclaimer.html" title="Help wiki:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
	<script type="text/javascript"> if (window.runOnloadHook) runOnloadHook();</script>
</div>
<!-- Served by 906f514f4f4c in 0.08 secs. -->
</body></html>
